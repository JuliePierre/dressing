<div class="main-body dashboard-container">
  <div class="subnav-left">
      <% avatar_url = current_user.facebook_picture_url || image_path('someone_icon.png') %>
      <%= image_tag(avatar_url, class: 'user-avatar') %>
      <h3><%= current_user.first_name.capitalize + " " + current_user.last_name.capitalize %></h3>
      <div class="subnav-tabs-container" id="subnav-tabs">
        <ul class="subnav-tabs">
          <li class="tab subnav-tab"><a href="#tab-moncompte" class="active">Mon compte</a></li>
          <li id="monprofil-link" class="tab subnav-tab"><a href="#tab-monprofil">Mon profil</a></li>
          <li id="monreseau-link" class="tab subnav-tab"><a href="#tab-monreseau">Mon reseau</a></li>
          <li id="mondressing-link" class="tab subnav-tab"><a href="#tab-mondressing">Mon dressing</a></li>
        </ul>
      </div>
  </div>
  <div class="dashboard-content-right bg-grey">
    <div class="full-height">

      <!-- TAB MON COMPTE -->
      <div class="tab-page" id="tab-moncompte">
        <div class="dashboard-content-header">
          <h2>Mon compte</h2>
        </div>
        <div class="tab-content">
          <div class="dashboard-links-card">
            <h3>Mon profil</h3>
            <p>Prénom : <%= current_user.first_name %></p>
            <p>Nom : <%= current_user.last_name %></p>
            <p>Email : <%= current_user.email %></p>
            <div id="link-to-monprofil">Modifier</div>
          </div>
          <div class="dashboard-links-card">
            <h3>Mon réseau</h3>
            <p>Vous avez <%= pluralize @actual_friends.size, "ami" %></p>
            <p>Vous avez <%= pluralize @pending_requests.size, "invitation" %> en attente</p>
            <div id="link-to-monreseau">Gérer</div>
          </div>
          <div class="dashboard-links-card">
            <h3>Mon dressing</h3>
            <p>Vous avez mis en ligne x produits</p>
            <div id="link-to-mondressing">Gérer</div>
          </div>
          <div class="dashboard-links-card">
            <h3>Mon panier</h3>
            <% if current_user.shopping_cart.nil? %>
              <p>Votre panier est vide</p>
              <%= link_to "Commencez votre lèche-vitrine", dressing_items_path %>
            <% else %>
              <p>Vous avez ajouté x produits à votre panier</p>
              <%= link_to "Accéder", shopping_cart_path(current_user.shopping_cart) %>
            <% end %>
          </div>
        </div>
      </div>

      <!-- TAB MON PROFIL -->
      <div class="tab-page" id="tab-monprofil">
        <div class="dashboard-content-header">
          <h2>Mon profil</h2>
        </div>
        <div class="user-form-container">
          <div class="user-form">
            <h2 class="text-center">Mettre à jour</h2>
            <%= simple_form_for(current_user, as: :user, url: session_path(:user)) do |f| %>
              <%= f.error_notification %>
              <div class="form-inputs">
                <%= f.input :email, required: false, autofocus: true, placeholder: "Votre email" %>
                <%= f.input :first_name, required: true, autofocus: true %>
                <%= f.input :last_name, required: true, autofocus: true %>
                <%= f.input :gender, required: true, autofocus: true, placeholder: "Genre", collection: [ [ "Homme", "male" ], [ "Femme", "female" ] ] %>
                <%= f.input :password, autocomplete: "off", hint: "leave it blank if you don't want to change it", required: false, placeholder: "password" %>
                <%= f.input :password_confirmation, required: false, placeholder: "confirm password" %>
                <%= f.input :current_password, hint: "we need your current password to confirm your changes", required: true, placeholder: "current password" %>
              </div>

              <div class="form-actions">
                <%= f.button :submit, "Mettre à jour", class: "b-btn" %>
              </div>
            <% end %>
          </div>
        </div>
      </div>

      <!-- TAB MON RESEAU -->
      <div class="tab-page" id="tab-monreseau">
        <div id="network-subnav-container">
          <ul class="network-subnav-tabs">
            <li id="mesamis-link" class="tab network-subnav-tab"><a href="#tab-mesamis" class="active">Mes amis</a></li>
            <li id="notifications-link" class="tab network-subnav-tab"><a href="#tab-notifications">Invitations <span class="notification-pin">( <%= @pending_requests.size %> )</span></a></li>
            <li id="ajouter-link" class="tab network-subnav-tab"><a href="#tab-ajouter">Ajouter</a></li>
            <div class="indicator" style="right: 1050px; left: 30px;"></div>
          </ul>
        </div>
        <div class="network-content">
          <div id="tab-mesamis">
            <div class="flexbox space-between">
              <% if @actual_friends.size == 0 %>
                <p>Vous n'avez pas encore d'ami</p>
              <% else %>
                <% @actual_friends.each do |user| %>
                  <div class="user-card">
                    <% image = user.gender == "male" ? 'boy.png' : 'girl.png' %>
                    <% avatar_url = user.facebook_picture_url || image_path(image) %>
                    <%= image_tag(avatar_url, class: 'user-avatar') %>
                    <h1><%= user.first_name %> <%= user.last_name %></h1>
                    <h5><%= user.email %></h5>
                    <%= link_to "", user_path(user), class: 'card-link user-card-link' %>
                  </div>
                <% end %>
              <% end %>
            </div>
            <div id="link-to-ajouter" class="b-btn">Chercher de nouveaux amis</div>
          </div>
          <div id="tab-notifications">
            <div class="flexbox space-between">
              <% @pending_requests.each do |user| %>
                <div class="user-card">
                  <% image = user.gender == "male" ? 'boy.png' : 'girl.png' %>
                  <% avatar_url = user.facebook_picture_url || image_path(image) %>
                  <%= image_tag(avatar_url, class: 'user-avatar') %>
                  <h1><%= user.first_name %> <%= user.last_name %></h1>
                  <h5><%= user.email %></h5>
                  <% friendship = Friendship.where('user_id = ? AND friend_id = ?', user.id, current_user.id).first %>
                  <%= link_to "Accepter", friendship_path(friendship), method: :patch, class: 'b-btn' %>
                </div>
              <% end %>
            </div>
          </div>
          <div id="tab-ajouter">
            <div class="flexbox space-between">
              <% @not_yet_friends.each do |user| %>
                <div class="user-card">
                  <% image = user.gender == "male" ? 'boy.png' : 'girl.png' %>
                  <% avatar_url = user.facebook_picture_url || image_path(image) %>
                  <%= image_tag(avatar_url, class: 'user-avatar') %>
                  <h1><%= user.first_name %> <%= user.last_name %></h1>
                  <h5><%= user.email %></h5>
                  <% if @pending_requests.include?(user) %>
                    <p>Attend votre réponse</p>
                  <% elsif @friend_invitations.include?(user) %>
                    <p>En attente de sa confirmation</p>
                  <% else %>
                    <%= link_to "Inviter", friendships_path(:friend_id => user), :method => :post, class: 'b-btn' %>
                  <% end %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <!-- TAB MON DRESSING -->
      <div class="tab-page" id="tab-mondressing">
        <div class="dashboard-content-header flexbox space-between">
          <h2>Mon dressing</h2>
          <%= link_to "Ajouter", new_dressing_item_path, class: "b-btn no-margin" %>
        </div>
        <div class="tab-content">
          <div class="flexbox">
            <% @dressing_items.each do |item| %>
              <% unless item.photos.size == 0 %>
                <div class="dressing-item-container">
                  <div class="dressing-item-card" style="background-image: url(<%= cl_image_path item.photos[0] %>);">
                  </div>
                  <h2><%= item.name %></h2>
                  <p><%= item.price %> €</p>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- <div class="main-body">
  <div class="bg-grey">
    <div class="container">
      <div class="b-section">
        <div class="flexbox space-between flex-start">
          <div>
            <h2>Mon compte</h2>
            <p>Bienvenue <%#= @user.first_name %> !</p>
            <p>Ceci est votre espace personnel. Vous pouvez modifier les paramètres de votre compte.</p>
          </div>
          <div class="mobile-full-width">
            <%#= link_to "Se déconnecter", destroy_user_session_path, method: :delete, class: "b-btn" %>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div id="dashboard-introduction-container">
        <div class="dashboard-introduction-item">
          <p>Vous êtes membre depuis le :</p>
          <div class="dashboard-introduction-icon">
            <%#= @user.created_at.strftime('%d/%m/%Y') %>
          </div>
        </div>
        <div class="dashboard-introduction-item">
          <p>Votre réseau :</p>
          <div class="dashboard-introduction-icon">
            <%#= pluralize @actual_friends.size, "ami" %>
          </div>
        </div>
        <div class="dashboard-introduction-item">
          <p>Vous avez créé :</p>
          <div class="dashboard-introduction-icon">
            <%#= pluralize @user.vide_dressings.size, "vide-dressing" %>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div id="dashboard-cards-container">
        <div class="dashboard-card">
          <h2>Mes vide dressings</h2>
          <div><%#= link_to "Ma page publique", user_path(@user) %></div>
          <div><%#= link_to "Créer un nouveau vide-dressing", new_user_vide_dressing_path(@user) %></div>
        </div>
        <div class="dashboard-card">
          <h2>Paramètres du compte</h2>
          <div class="dashboard-infos-container">
            <div>
              <div><%#= link_to "Mes informations personnelles", edit_user_registration_path %></div> <! devrait rediriger vers edit d'un user !>
              <div><%#= link_to "Mon réseau", users_path %></div>
            </div>
            <div>
              <%# unless @user.shopping_cart.nil? %>
                <div><%#= link_to "Voir mon panier", shopping_cart_path(@user.shopping_cart) %></div>
              <%# end %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container last-container">
      <div class="b-section">
        <h2 class="text-center">Mes vide-dressings</h2>
        <div class="mes-vide-dressings-container">
          <%# unless @user.vide_dressings.size == 0 %>
            <%# @user.vide_dressings.each do |vide_dressing| %>
              <%# if vide_dressing.photo.nil? %>
                <%# bg = "dg4gaietgwflohnmddv0.jpg" %>
              <%# else %>
                <%# bg = vide_dressing.photo.path %>
              <%# end %>
              <div class="vide-dressing-card" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)),
               url('<%#= cl_image_path bg, height: 300, width: 400, crop: :fill %>')">
                <div class="card-sticker">
                  <h5><%#= vide_dressing.status %></h5>
                </div>
                <div class="vide-dressing-card-description">
                  <h2><%#= vide_dressing.name %></h2>
                </div>
                <div class="vide-dressing-card-icons">
                  <div class="vide-dressing-card-icon">
                    <%#= image_tag "cintre.png" %>
                    <h2><%#= vide_dressing.vide_dressing_items.size %></h2>
                  </div>
                  <div class="vide-dressing-card-icon">
                    <i class="material-icons">favorite_border</i>
                    <h2><%#= vide_dressing.marks_of_interest %></h2>
                  </div>
                </div>
                <%#= link_to "", user_vide_dressing_path(@user, vide_dressing), class: "card-link" %>
              </div>
            <%# end %>
          <%# end %>
        </div>
      </div>
    </div>
  </div>
</div>
 -->
<% content_for(:after_js) do %>
  <script>
    $(document).ready(function(){
      $('ul.subnav-tabs').tabs();
      $('ul.network-subnav-tabs').tabs();
      $('select').material_select();
    });
  </script>
<% end %>
